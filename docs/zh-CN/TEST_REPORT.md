# @dreamer/auth æµ‹è¯•æŠ¥å‘Š

## ğŸ“Š æµ‹è¯•æ¦‚è§ˆ

| é¡¹ç›®           | å€¼                        |
| -------------- | ------------------------- |
| **æµ‹è¯•åŒ…ç‰ˆæœ¬** | `@dreamer/auth@1.0.0`     |
| **åŠ å¯†åŒ…ç‰ˆæœ¬** | `@dreamer/crypto@^1.0.1`  |
| **ä¼šè¯åŒ…ç‰ˆæœ¬** | `@dreamer/session@^1.0.3` |
| **æµ‹è¯•æ¡†æ¶**   | `@dreamer/test@^1.0.11`   |
| **æµ‹è¯•æ—¶é—´**   | `2026-02-19`              |
| **æµ‹è¯•ç¯å¢ƒ**   | Deno 2.5+, Bun 1.3+       |

---

## ğŸ¯ æµ‹è¯•ç»“æœ

### æ€»ä½“ç»Ÿè®¡

| æŒ‡æ ‡         | Deno | Bun   |
| ------------ | ---- | ----- |
| **æ€»æµ‹è¯•æ•°** | 128  | 123   |
| **é€šè¿‡**     | 128  | 123   |
| **å¤±è´¥**     | 0    | 0     |
| **é€šè¿‡ç‡**   | 100% | 100%  |
| **æ‰§è¡Œæ—¶é—´** | ~6s  | ~4.6s |

### æµ‹è¯•æ–‡ä»¶ç»Ÿè®¡

| æµ‹è¯•æ–‡ä»¶          | æµ‹è¯•æ•° | é€šè¿‡ | å¤±è´¥ | çŠ¶æ€    |
| ----------------- | ------ | ---- | ---- | ------- |
| `jwt.test.ts`     | 22     | 22   | 0    | âœ… é€šè¿‡ |
| `mod.test.ts`     | 45     | 45   | 0    | âœ… é€šè¿‡ |
| `oauth.test.ts`   | 22     | 22   | 0    | âœ… é€šè¿‡ |
| `refresh.test.ts` | 15     | 15   | 0    | âœ… é€šè¿‡ |
| `session.test.ts` | 24     | 24   | 0    | âœ… é€šè¿‡ |

---

## ğŸ“‹ åŠŸèƒ½æµ‹è¯•è¯¦æƒ…

### 1. JWT ç­¾åä¸éªŒè¯ (jwt.test.ts) - 22 ä¸ªæµ‹è¯•

#### signToken - JWT ç­¾å (3 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                   | çŠ¶æ€ |
| -------------------------- | ---- |
| åº”è¯¥ä½¿ç”¨ HS256 ç­¾å JWT    | âœ…   |
| åº”è¯¥åŒ…å«æ­£ç¡®çš„ payload     | âœ…   |
| åº”è¯¥æ”¯æŒä¸åŒçš„è¿‡æœŸæ—¶é—´æ ¼å¼ | âœ…   |

#### verifyToken - JWT éªŒè¯ (4 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯             | çŠ¶æ€ |
| -------------------- | ---- |
| åº”è¯¥éªŒè¯æœ‰æ•ˆçš„ JWT   | âœ…   |
| åº”è¯¥æ‹’ç»é”™è¯¯çš„å¯†é’¥   | âœ…   |
| åº”è¯¥æ‹’ç»è¿‡æœŸçš„ Token | âœ…   |
| åº”è¯¥éªŒè¯ç­¾å‘è€…       | âœ…   |

#### decodeToken - JWT è§£ç  (2 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                       | çŠ¶æ€ |
| ------------------------------ | ---- |
| åº”è¯¥è§£ç  JWT Header å’Œ Payload | âœ…   |
| åº”è¯¥æŠ›å‡ºæ— æ•ˆ Token æ ¼å¼é”™è¯¯    | âœ…   |

#### isTokenExpired - è¿‡æœŸæ£€æŸ¥ (3 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                          | çŠ¶æ€ |
| --------------------------------- | ---- |
| åº”è¯¥è¿”å› false å¯¹äºæœªè¿‡æœŸçš„ Token | âœ…   |
| åº”è¯¥è¿”å› true å¯¹äºè¿‡æœŸçš„ Token    | âœ…   |
| åº”è¯¥è¿”å› true å¯¹äºæ— æ•ˆçš„ Token    | âœ…   |

#### getTokenExpiration - è·å–è¿‡æœŸæ—¶é—´ (2 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                             | çŠ¶æ€ |
| ------------------------------------ | ---- |
| åº”è¯¥è¿”å›è¿‡æœŸæ—¶é—´æˆ³                   | âœ…   |
| åº”è¯¥è¿”å› null å¯¹äºæ— è¿‡æœŸæ—¶é—´çš„ Token | âœ…   |

#### getTokenRemainingTime - è·å–å‰©ä½™æ—¶é—´ (3 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                           | çŠ¶æ€ |
| ---------------------------------- | ---- |
| åº”è¯¥è¿”å›æ­£ç¡®çš„å‰©ä½™æ—¶é—´             | âœ…   |
| åº”è¯¥è¿”å› 0 å¯¹äºè¿‡æœŸçš„ Token        | âœ…   |
| åº”è¯¥è¿”å› -1 å¯¹äºæ— è¿‡æœŸæ—¶é—´çš„ Token | âœ…   |

#### generateRSAKeyPair - RSA å¯†é’¥å¯¹ç”Ÿæˆ (2 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                    | çŠ¶æ€ |
| --------------------------- | ---- |
| åº”è¯¥ç”Ÿæˆ RSA å¯†é’¥å¯¹         | âœ…   |
| åº”è¯¥ä½¿ç”¨ RSA å¯†é’¥ç­¾åå’ŒéªŒè¯ | âœ…   |

#### generateECKeyPair - ECDSA å¯†é’¥å¯¹ç”Ÿæˆ (2 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                      | çŠ¶æ€ |
| ----------------------------- | ---- |
| åº”è¯¥ç”Ÿæˆ ECDSA å¯†é’¥å¯¹         | âœ…   |
| åº”è¯¥ä½¿ç”¨ ECDSA å¯†é’¥ç­¾åå’ŒéªŒè¯ | âœ…   |

---

### 2. è®¤è¯å·¥å…·å‡½æ•° (mod.test.ts) - 45 ä¸ªæµ‹è¯•

#### parseBearerToken - Bearer Token è§£æ (4 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                         | çŠ¶æ€ |
| -------------------------------- | ---- |
| åº”è¯¥è§£ææœ‰æ•ˆçš„ Bearer Token      | âœ…   |
| åº”è¯¥è¿”å› null å¯¹äº null è¾“å…¥     | âœ…   |
| åº”è¯¥è¿”å› null å¯¹äºé Bearer å‰ç¼€ | âœ…   |
| åº”è¯¥è¿”å› null å¯¹äºç©ºå­—ç¬¦ä¸²       | âœ…   |

#### parseBasicAuth - Basic Auth è§£æ (3 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                   | çŠ¶æ€ |
| -------------------------- | ---- |
| åº”è¯¥è§£ææœ‰æ•ˆçš„ Basic Auth  | âœ…   |
| åº”è¯¥å¤„ç†åŒ…å«å†’å·çš„å¯†ç      | âœ…   |
| åº”è¯¥è¿”å› null å¯¹äºæ— æ•ˆè¾“å…¥ | âœ…   |

#### createBasicAuthHeader - Basic Auth å¤´ç”Ÿæˆ (1 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                     | çŠ¶æ€ |
| ---------------------------- | ---- |
| åº”è¯¥ç”Ÿæˆæ­£ç¡®çš„ Basic Auth å¤´ | âœ…   |

#### createBearerAuthHeader - Bearer Auth å¤´ç”Ÿæˆ (1 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                      | çŠ¶æ€ |
| ----------------------------- | ---- |
| åº”è¯¥ç”Ÿæˆæ­£ç¡®çš„ Bearer Auth å¤´ | âœ…   |

#### parseJwt - JWT è§£æ (2 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                     | çŠ¶æ€ |
| ---------------------------- | ---- |
| åº”è¯¥è§£ææœ‰æ•ˆçš„ JWT           | âœ…   |
| åº”è¯¥è¿”å› null å¯¹äºæ— æ•ˆ Token | âœ…   |

#### isJwtExpired - JWT è¿‡æœŸæ£€æŸ¥ (4 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                                  | çŠ¶æ€ |
| ----------------------------------------- | ---- |
| åº”è¯¥è¿”å› true å¯¹äº null payload           | âœ…   |
| åº”è¯¥è¿”å› false å¯¹äºæ²¡æœ‰è¿‡æœŸæ—¶é—´çš„ payload | âœ…   |
| åº”è¯¥è¿”å› true å¯¹äºå·²è¿‡æœŸçš„ payload        | âœ…   |
| åº”è¯¥è¿”å› false å¯¹äºæœªè¿‡æœŸçš„ payload       | âœ…   |

#### validateJwtClaims - JWT Claims éªŒè¯ (3 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                       | çŠ¶æ€ |
| ------------------------------ | ---- |
| åº”è¯¥éªŒè¯é€šè¿‡å¯¹äºæœ‰æ•ˆçš„ payload | âœ…   |
| åº”è¯¥éªŒè¯å¤±è´¥å¯¹äºè¿‡æœŸçš„ payload | âœ…   |
| åº”è¯¥éªŒè¯å¤±è´¥å¯¹äºç­¾å‘è€…ä¸åŒ¹é…   | âœ…   |

#### extractUserFromJwt - ä» JWT æå–ç”¨æˆ· (2 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                        | çŠ¶æ€ |
| ------------------------------- | ---- |
| åº”è¯¥æå–ç”¨æˆ·ä¿¡æ¯                | âœ…   |
| åº”è¯¥è¿”å› null å¯¹äº null payload | âœ…   |

#### è§’è‰²æ£€æŸ¥ - hasRole (3 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                        | çŠ¶æ€ |
| ------------------------------- | ---- |
| åº”è¯¥è¿”å› true å¦‚æœç”¨æˆ·æœ‰è§’è‰²    | âœ…   |
| åº”è¯¥è¿”å› false å¦‚æœç”¨æˆ·æ²¡æœ‰è§’è‰² | âœ…   |
| åº”è¯¥è¿”å› false å¯¹äº null ç”¨æˆ·   | âœ…   |

#### è§’è‰²æ£€æŸ¥ - hasAnyRole (2 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                            | çŠ¶æ€ |
| ----------------------------------- | ---- |
| åº”è¯¥è¿”å› true å¦‚æœç”¨æˆ·æœ‰ä»»æ„è§’è‰²    | âœ…   |
| åº”è¯¥è¿”å› false å¦‚æœç”¨æˆ·æ²¡æœ‰ä»»ä½•è§’è‰² | âœ…   |

#### è§’è‰²æ£€æŸ¥ - hasAllRoles (2 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                            | çŠ¶æ€ |
| ----------------------------------- | ---- |
| åº”è¯¥è¿”å› true å¦‚æœç”¨æˆ·æœ‰æ‰€æœ‰è§’è‰²    | âœ…   |
| åº”è¯¥è¿”å› false å¦‚æœç”¨æˆ·ç¼ºå°‘ä»»ä½•è§’è‰² | âœ…   |

#### æƒé™æ£€æŸ¥ - hasPermission (2 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                        | çŠ¶æ€ |
| ------------------------------- | ---- |
| åº”è¯¥è¿”å› true å¦‚æœç”¨æˆ·æœ‰æƒé™    | âœ…   |
| åº”è¯¥è¿”å› false å¦‚æœç”¨æˆ·æ²¡æœ‰æƒé™ | âœ…   |

#### æƒé™æ£€æŸ¥ - hasAnyPermission (2 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                            | çŠ¶æ€ |
| ----------------------------------- | ---- |
| åº”è¯¥è¿”å› true å¦‚æœç”¨æˆ·æœ‰ä»»æ„æƒé™    | âœ…   |
| åº”è¯¥è¿”å› false å¦‚æœç”¨æˆ·æ²¡æœ‰ä»»ä½•æƒé™ | âœ…   |

#### æƒé™æ£€æŸ¥ - hasAllPermissions (2 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                            | çŠ¶æ€ |
| ----------------------------------- | ---- |
| åº”è¯¥è¿”å› true å¦‚æœç”¨æˆ·æœ‰æ‰€æœ‰æƒé™    | âœ…   |
| åº”è¯¥è¿”å› false å¦‚æœç”¨æˆ·ç¼ºå°‘ä»»ä½•æƒé™ | âœ…   |

#### matchPath - è·¯å¾„åŒ¹é… (5 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                           | çŠ¶æ€ |
| ---------------------------------- | ---- |
| åº”è¯¥åŒ¹é…ç²¾ç¡®è·¯å¾„                   | âœ…   |
| åº”è¯¥åŒ¹é…å‰ç¼€è·¯å¾„                   | âœ…   |
| åº”è¯¥åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼                 | âœ…   |
| åº”è¯¥è¿”å› false å¯¹äºä¸åŒ¹é…çš„è·¯å¾„    | âœ…   |
| åº”è¯¥è¿”å› false å¯¹äº undefined è·¯å¾„ | âœ…   |

#### requiresAuth - è®¤è¯éœ€æ±‚æ£€æŸ¥ (3 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                     | çŠ¶æ€ |
| ---------------------------- | ---- |
| åº”è¯¥è¿”å› false å¯¹äºå…¬å¼€è·¯å¾„  | âœ…   |
| åº”è¯¥è¿”å› true å¯¹äºå—ä¿æŠ¤è·¯å¾„ | âœ…   |
| åº”è¯¥è¿”å› true é»˜è®¤æƒ…å†µ       | âœ…   |

#### getRequiredRoles - è·å–æ‰€éœ€è§’è‰² (3 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                       | çŠ¶æ€ |
| ------------------------------ | ---- |
| åº”è¯¥è¿”å›ç²¾ç¡®åŒ¹é…çš„è§’è‰²         | âœ…   |
| åº”è¯¥è¿”å›å‰ç¼€åŒ¹é…çš„è§’è‰²         | âœ…   |
| åº”è¯¥è¿”å›ç©ºæ•°ç»„å¯¹äºä¸åŒ¹é…çš„è·¯å¾„ | âœ…   |

---

### 3. OAuth 2.0 å®¢æˆ·ç«¯ (oauth.test.ts) - 22 ä¸ªæµ‹è¯•

#### generatePKCE - PKCE å‚æ•°ç”Ÿæˆ (2 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                                 | çŠ¶æ€ |
| ---------------------------------------- | ---- |
| åº”è¯¥ç”Ÿæˆ code_verifier å’Œ code_challenge | âœ…   |
| åº”è¯¥æ¯æ¬¡ç”Ÿæˆä¸åŒçš„ PKCE å‚æ•°             | âœ…   |

#### generateState - çŠ¶æ€å‚æ•°ç”Ÿæˆ (2 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯               | çŠ¶æ€ |
| ---------------------- | ---- |
| åº”è¯¥ç”ŸæˆéšæœºçŠ¶æ€å­—ç¬¦ä¸² | âœ…   |
| åº”è¯¥æ¯æ¬¡ç”Ÿæˆä¸åŒçš„çŠ¶æ€ | âœ…   |

#### OAuth2Client - å®¢æˆ·ç«¯ (5 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯             | çŠ¶æ€ |
| -------------------- | ---- |
| åº”è¯¥ç”Ÿæˆæˆæƒ URL     | âœ…   |
| åº”è¯¥æ”¯æŒè‡ªå®šä¹‰ scope | âœ…   |
| åº”è¯¥æ”¯æŒ state å‚æ•°  | âœ…   |
| åº”è¯¥æ”¯æŒ PKCE        | âœ…   |
| åº”è¯¥æ”¯æŒé¢å¤–å‚æ•°     | âœ…   |

#### å†…ç½® Provider é…ç½® (5 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                         | çŠ¶æ€ |
| -------------------------------- | ---- |
| GitHub Provider åº”è¯¥æœ‰æ­£ç¡®çš„ç«¯ç‚¹ | âœ…   |
| Google Provider åº”è¯¥æœ‰æ­£ç¡®çš„ç«¯ç‚¹ | âœ…   |
| WeChat Provider åº”è¯¥æœ‰æ­£ç¡®çš„ç«¯ç‚¹ | âœ…   |
| GitLab Provider åº”è¯¥æœ‰æ­£ç¡®çš„ç«¯ç‚¹ | âœ…   |
| Gitee Provider åº”è¯¥æœ‰æ­£ç¡®çš„ç«¯ç‚¹  | âœ…   |

#### ç”¨æˆ·ä¿¡æ¯è§£æå™¨ (4 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                     | çŠ¶æ€ |
| ---------------------------- | ---- |
| parseGitHubUser åº”è¯¥æ­£ç¡®è§£æ | âœ…   |
| parseGoogleUser åº”è¯¥æ­£ç¡®è§£æ | âœ…   |
| parseGitLabUser åº”è¯¥æ­£ç¡®è§£æ | âœ…   |
| parseGiteeUser åº”è¯¥æ­£ç¡®è§£æ  | âœ…   |

#### å·¥å‚å‡½æ•° (3 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                                  | çŠ¶æ€ |
| ----------------------------------------- | ---- |
| createOAuth2Client åº”è¯¥åˆ›å»ºå®¢æˆ·ç«¯         | âœ…   |
| createGitHubClient åº”è¯¥åˆ›å»º GitHub å®¢æˆ·ç«¯ | âœ…   |
| createGoogleClient åº”è¯¥åˆ›å»º Google å®¢æˆ·ç«¯ | âœ…   |

---

### 4. Token åˆ·æ–°ç®¡ç† (refresh.test.ts) - 15 ä¸ªæµ‹è¯•

#### MemoryTokenStore - å†…å­˜å­˜å‚¨ (5 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                         | çŠ¶æ€ |
| -------------------------------- | ---- |
| åº”è¯¥ä¿å­˜å’Œè·å– Token             | âœ…   |
| åº”è¯¥è¿”å› null å¯¹äºä¸å­˜åœ¨çš„ Token | âœ…   |
| åº”è¯¥åˆ é™¤ Token                   | âœ…   |
| åº”è¯¥æŒ‰ç”¨æˆ·åˆ é™¤æ‰€æœ‰ Token         | âœ…   |
| åº”è¯¥è¿”å› null å¯¹äºè¿‡æœŸçš„ Token   | âœ…   |

#### TokenManager - Token ç®¡ç†å™¨ (8 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                           | çŠ¶æ€ |
| ---------------------------------- | ---- |
| åº”è¯¥ç”Ÿæˆ Token å¯¹                  | âœ…   |
| åº”è¯¥éªŒè¯ Access Token              | âœ…   |
| åº”è¯¥åˆ·æ–° Token                     | âœ…   |
| åº”è¯¥æ‹’ç»ä½¿ç”¨å·²åˆ·æ–°çš„ Refresh Token | âœ…   |
| åº”è¯¥æ’¤é”€ Refresh Token             | âœ…   |
| åº”è¯¥æ’¤é”€ç”¨æˆ·çš„æ‰€æœ‰ Token           | âœ…   |
| åº”è¯¥æ£€æŸ¥ Token æ˜¯å¦éœ€è¦åˆ·æ–°        | âœ…   |
| åº”è¯¥æ£€æŸ¥ Token æ˜¯å¦è¿‡æœŸ            | âœ…   |

#### createTokenManager - å·¥å‚å‡½æ•° (1 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                   | çŠ¶æ€ |
| -------------------------- | ---- |
| åº”è¯¥åˆ›å»º TokenManager å®ä¾‹ | âœ…   |

---

### 5. è®¤è¯ä¼šè¯ç®¡ç† (session.test.ts) - 24 ä¸ªæµ‹è¯•

#### AuthSessionManager - login ç™»å½• (2 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                       | çŠ¶æ€ |
| ------------------------------ | ---- |
| åº”è¯¥åˆ›å»º Session å¹¶è®¾ç½® Cookie | âœ…   |
| åº”è¯¥å°† Session å­˜å‚¨åˆ° store    | âœ…   |

#### AuthSessionManager - logout ç™»å‡º (2 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                   | çŠ¶æ€ |
| -------------------------- | ---- |
| åº”è¯¥åˆ é™¤ Session å’Œ Cookie | âœ…   |
| åº”è¯¥å¤„ç†æœªç™»å½•çš„æƒ…å†µ       | âœ…   |

#### AuthSessionManager - isAuthenticated è®¤è¯æ£€æŸ¥ (3 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                        | çŠ¶æ€ |
| ------------------------------- | ---- |
| åº”è¯¥è¿”å› true å¯¹äºå·²ç™»å½•ç”¨æˆ·    | âœ…   |
| åº”è¯¥è¿”å› false å¯¹äºæœªç™»å½•ç”¨æˆ·   | âœ…   |
| åº”è¯¥è¿”å› false å¯¹äºç™»å‡ºåçš„ç”¨æˆ· | âœ…   |

#### AuthSessionManager - getUser è·å–ç”¨æˆ· (2 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                     | çŠ¶æ€ |
| ---------------------------- | ---- |
| åº”è¯¥è¿”å›å·²ç™»å½•ç”¨æˆ·ä¿¡æ¯       | âœ…   |
| åº”è¯¥è¿”å› null å¯¹äºæœªç™»å½•ç”¨æˆ· | âœ…   |

#### AuthSessionManager - loadSession åŠ è½½ Session (4 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                                      | çŠ¶æ€ |
| --------------------------------------------- | ---- |
| åº”è¯¥ä» Cookie åŠ è½½ Session                    | âœ…   |
| åº”è¯¥è¿”å› false å¯¹äºæ—  Cookie çš„è¯·æ±‚           | âœ…   |
| åº”è¯¥è¿”å› false å¹¶æ¸…é™¤ Cookie å¯¹äºæ— æ•ˆ Session | âœ…   |
| åº”è¯¥æ›´æ–°æœ€åæ´»åŠ¨æ—¶é—´                          | âœ…   |

#### AuthSessionManager - middleware ä¸­é—´ä»¶ (2 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                       | çŠ¶æ€ |
| ------------------------------ | ---- |
| åº”è¯¥è‡ªåŠ¨åŠ è½½ Session           | âœ…   |
| åº”è¯¥åœ¨æ—  Session æ—¶ä¹Ÿè°ƒç”¨ next | âœ…   |

#### AuthSessionManager - requireAuth è®¤è¯ä¿æŠ¤ä¸­é—´ä»¶ (3 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                       | çŠ¶æ€ |
| ------------------------------ | ---- |
| åº”è¯¥å…è®¸å·²è®¤è¯ç”¨æˆ·é€šè¿‡         | âœ…   |
| åº”è¯¥è¿”å› 401 å¯¹äºæœªè®¤è¯ç”¨æˆ·    | âœ…   |
| åº”è¯¥é‡å®šå‘æœªè®¤è¯ç”¨æˆ·åˆ°æŒ‡å®š URL | âœ…   |

#### createAuthSession - å·¥å‚å‡½æ•° (2 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                         | çŠ¶æ€ |
| -------------------------------- | ---- |
| åº”è¯¥åˆ›å»º AuthSessionManager å®ä¾‹ | âœ…   |
| åº”è¯¥ä½¿ç”¨è‡ªå®šä¹‰é…ç½®               | âœ…   |

#### ç”¨æˆ·åºåˆ—åŒ– (3 ä¸ªæµ‹è¯•)

| æµ‹è¯•åœºæ™¯                       | çŠ¶æ€ |
| ------------------------------ | ---- |
| åº”è¯¥æ”¯æŒè‡ªå®šä¹‰åºåˆ—åŒ–å‡½æ•°       | âœ…   |
| åº”è¯¥æ”¯æŒè‡ªå®šä¹‰ååºåˆ—åŒ–å‡½æ•°     | âœ…   |
| åº”è¯¥åœ¨ç”¨æˆ·ä¸å­˜åœ¨æ—¶åˆ é™¤ Session | âœ…   |

---

## ğŸ“ˆ æµ‹è¯•è¦†ç›–åˆ†æ

### æ¥å£æ–¹æ³•è¦†ç›–

| æ¨¡å—         | æ–¹æ³•/åŠŸèƒ½                | è¦†ç›–çŠ¶æ€ |
| ------------ | ------------------------ | -------- |
| `jwt.ts`     | `signToken`              | âœ…       |
| `jwt.ts`     | `verifyToken`            | âœ…       |
| `jwt.ts`     | `decodeToken`            | âœ…       |
| `jwt.ts`     | `isTokenExpired`         | âœ…       |
| `jwt.ts`     | `getTokenExpiration`     | âœ…       |
| `jwt.ts`     | `getTokenRemainingTime`  | âœ…       |
| `jwt.ts`     | `generateRSAKeyPair`     | âœ…       |
| `jwt.ts`     | `generateECKeyPair`      | âœ…       |
| `mod.ts`     | `parseBearerToken`       | âœ…       |
| `mod.ts`     | `parseBasicAuth`         | âœ…       |
| `mod.ts`     | `createBasicAuthHeader`  | âœ…       |
| `mod.ts`     | `createBearerAuthHeader` | âœ…       |
| `mod.ts`     | `parseJwt`               | âœ…       |
| `mod.ts`     | `isJwtExpired`           | âœ…       |
| `mod.ts`     | `validateJwtClaims`      | âœ…       |
| `mod.ts`     | `extractUserFromJwt`     | âœ…       |
| `mod.ts`     | `hasRole`                | âœ…       |
| `mod.ts`     | `hasAnyRole`             | âœ…       |
| `mod.ts`     | `hasAllRoles`            | âœ…       |
| `mod.ts`     | `hasPermission`          | âœ…       |
| `mod.ts`     | `hasAnyPermission`       | âœ…       |
| `mod.ts`     | `hasAllPermissions`      | âœ…       |
| `mod.ts`     | `matchPath`              | âœ…       |
| `mod.ts`     | `requiresAuth`           | âœ…       |
| `mod.ts`     | `getRequiredRoles`       | âœ…       |
| `oauth.ts`   | `generatePKCE`           | âœ…       |
| `oauth.ts`   | `generateState`          | âœ…       |
| `oauth.ts`   | `OAuth2Client`           | âœ…       |
| `oauth.ts`   | `createOAuth2Client`     | âœ…       |
| `oauth.ts`   | `createGitHubClient`     | âœ…       |
| `oauth.ts`   | `createGoogleClient`     | âœ…       |
| `refresh.ts` | `MemoryTokenStore`       | âœ…       |
| `refresh.ts` | `TokenManager`           | âœ…       |
| `refresh.ts` | `createTokenManager`     | âœ…       |
| `session.ts` | `AuthSessionManager`     | âœ…       |
| `session.ts` | `createAuthSession`      | âœ…       |

### è¾¹ç•Œæƒ…å†µè¦†ç›–

| åœºæ™¯                | è¦†ç›–çŠ¶æ€ |
| ------------------- | -------- |
| null/undefined è¾“å…¥ | âœ…       |
| ç©ºå­—ç¬¦ä¸²å¤„ç†        | âœ…       |
| æ— æ•ˆ Token æ ¼å¼     | âœ…       |
| è¿‡æœŸ Token å¤„ç†     | âœ…       |
| é”™è¯¯å¯†é’¥éªŒè¯        | âœ…       |
| ä¸å­˜åœ¨çš„ Session    | âœ…       |
| ç”¨æˆ·æ— è§’è‰²/æƒé™     | âœ…       |
| è·¯å¾„ä¸åŒ¹é…          | âœ…       |

### é”™è¯¯å¤„ç†è¦†ç›–

| åœºæ™¯                      | è¦†ç›–çŠ¶æ€ |
| ------------------------- | -------- |
| æ— æ•ˆ Token æŠ›å‡ºé”™è¯¯       | âœ…       |
| éªŒè¯å¤±è´¥è¿”å› null         | âœ…       |
| è¿‡æœŸ Token æ‹’ç»           | âœ…       |
| å·²ä½¿ç”¨ Refresh Token æ‹’ç» | âœ…       |
| æœªè®¤è¯ç”¨æˆ·è¿”å› 401        | âœ…       |
| ç­¾å‘è€…ä¸åŒ¹é…éªŒè¯å¤±è´¥      | âœ…       |

---

## âœ¨ ä¼˜ç‚¹

1. **å®Œæ•´çš„ JWT æ”¯æŒ**ï¼šæ”¯æŒ HS256ã€RS256ã€ES256
   ç­‰å¤šç§ç®—æ³•ï¼Œæä¾›ç­¾åã€éªŒè¯ã€è§£ç ç­‰å®Œæ•´åŠŸèƒ½
2. **çµæ´»çš„ OAuth 2.0**ï¼šå†…ç½® GitHubã€Googleã€WeChatã€GitLabã€Gitee ç­‰å¤šç§
   Providerï¼Œæ”¯æŒ PKCE
3. **Token åˆ·æ–°æœºåˆ¶**ï¼šæä¾› Access Token + Refresh Token çš„åŒ Token æœºåˆ¶ï¼Œæ”¯æŒ
   Token æ’¤é”€
4. **ä¼šè¯ç®¡ç†é›†æˆ**ï¼šä¸ `@dreamer/session`
   æ·±åº¦é›†æˆï¼Œæä¾›ç™»å½•ã€ç™»å‡ºã€è®¤è¯æ£€æŸ¥ç­‰åŠŸèƒ½
5. **æƒé™éªŒè¯**ï¼šæ”¯æŒè§’è‰²ã€æƒé™æ£€æŸ¥ï¼Œæ”¯æŒè·¯å¾„åŒ¹é…å’Œè®¤è¯éœ€æ±‚é…ç½®
6. **è·¨è¿è¡Œæ—¶å…¼å®¹**ï¼šå®Œå…¨å…¼å®¹ Deno å’Œ Bun è¿è¡Œæ—¶

---

## ğŸ“ ç»“è®º

@dreamer/auth çš„ 123 ä¸ªæµ‹è¯•å…¨éƒ¨é€šè¿‡ï¼Œè¦†ç›–äº† JWT ç­¾åéªŒè¯ã€OAuth 2.0
å®¢æˆ·ç«¯ã€Token
åˆ·æ–°ç®¡ç†ã€è®¤è¯ä¼šè¯ç®¡ç†å’Œæƒé™éªŒè¯ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚åŒ…æä¾›äº†å®Œæ•´çš„è®¤è¯è§£å†³æ–¹æ¡ˆï¼Œæ”¯æŒå¤šç§è®¤è¯æ–¹å¼å’Œ
OAuth Providerï¼Œå¹¶é€šè¿‡ Deno å’Œ Bun åŒè¿è¡Œæ—¶æµ‹è¯•éªŒè¯äº†è·¨å¹³å°å…¼å®¹æ€§ã€‚

---

<div align="center">

**æµ‹è¯•é€šè¿‡ç‡ï¼š100%** âœ…

_å…± 123 ä¸ªæµ‹è¯• | Deno é€šè¿‡ | Bun é€šè¿‡_

</div>
